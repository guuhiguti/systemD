<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Recursos - {{ tipo|capitalize }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>

  <body class="p-4 bg-light">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="fw-bold">Doa+</h1>
      <div>
        <span class="me-3">Olá, <strong>{{ usuario.nome }}</strong>!</span>
        <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-danger btn-sm">Sair</a>
      </div>
    </div>

    <h3 class="mb-3">Categoria: {{ tipo|capitalize }}</h3>
    <a href="{{ url_for('home.home') }}" class="btn btn-secondary mb-3">← Voltar</a>

    {% if usuario.tipo == "colaborador" %}
      <p>Selecione um item para contribuir:</p>
    {% endif %}

    {% if recursos and recursos|length > 0 %}
      <table class="table table-striped">
        <thead class="table-light">
          <tr>
            <th>Item</th>
            <th>Descrição</th>
            <th>Quantidade</th>
            <th>Responsável</th>
            {% if usuario.tipo == "colaborador" %}
              <th>Ação</th>
            {% endif %}
          </tr>
        </thead>
        <tbody>
          {% for recurso in recursos %}
          <tr>
            <td>{{ recurso.item }}</td>
            <td>{{ recurso.descricao }}</td>
            <td>{{ recurso.quantidade }}</td>
            <td>{{ recurso.responsavel }}</td>

            {% if usuario.tipo == "colaborador" %}
              <td>
                <form action="{{ url_for('admin.registrar_doacao', recurso_id=recurso.id) }}" method="post">
                  <input type="hidden" name="usuario" value="{{ usuario.nome }}">
                  <button type="submit" class="btn btn-success btn-sm">Doar</button>
                </form>
              </td>
            {% endif %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="text-muted">Nenhum recurso cadastrado nesta categoria.</p>
    {% endif %}

    {% if usuario.tipo in ["administrador", "instituicao"] %}
      <a href="{{ url_for('admin.novo_recurso') }}" class="btn btn-success mt-3">Adicionar Novo Recurso</a>
    {% endif %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
